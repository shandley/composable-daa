# Figure Legends - LinDA Sensitivity Analysis

## Figure 1: Power Curves

**File**: `fig1_power_curves.png/pdf`

Four-panel figure showing sensitivity (power) curves for each method across effect sizes.

**Panels A-D**: Each panel shows one method (LinDA, ZINB, Hurdle, NB) with sensitivity on the y-axis and true effect size (log2 fold change) on the x-axis. Different line colors represent different q-value thresholds (0.05, 0.10, 0.15). Gray dashed line indicates 80% power.

**Key observation**: LinDA shows 0% sensitivity at all effect sizes with q < 0.05, but achieves 39% sensitivity at 4.0 log2FC with q < 0.10. ZINB and Hurdle show higher sensitivity (83%) at q < 0.05 for large effects.

---

## Figure 2: Method Comparison

**File**: `fig2_method_comparison.png/pdf`

**Panel A**: Grouped bar chart showing sensitivity at 4.0 log2FC (16x fold change) for each method at different q-value thresholds. LinDA shows 0% sensitivity at q < 0.05 but 39% at q < 0.10. ZINB and Hurdle achieve 83% sensitivity at q < 0.05.

**Panel B**: Sensitivity vs FDR tradeoff scatter plot. Each point represents a method at a specific threshold. LinDA (purple) achieves low FDR (12.5%) but low sensitivity (39%). ZINB (green) and Hurdle (blue) achieve high sensitivity (83%) with moderate FDR (25-29%).

---

## Figure 3: CLR Attenuation

**File**: `fig3_clr_attenuation.png/pdf`

**Panel A**: True vs observed effect size scatter plot. Dashed line shows perfect 1:1 recovery. LinDA (purple) shows severe attenuation (~25% of true effect recovered). ZINB (green) and Hurdle (blue) closely track the identity line (~90% recovery).

**Panel B**: Bar chart of attenuation factors by method. LinDA shows 25% recovery (75% attenuation), while ZINB (90%), Hurdle (88%), and NB (95%) all show minimal attenuation.

---

## Figure 4: Threshold Optimization

**File**: `fig4_threshold_optimization.png/pdf`

Bar chart comparing LinDA sensitivity and FDR at different q-value thresholds (0.01, 0.05, 0.10, 0.15, 0.20) for 4.0 log2FC effect size. Green bars show sensitivity, red bars show FDR.

**Key finding**: At q < 0.05, LinDA has 0% sensitivity. At q < 0.10, LinDA achieves 39% sensitivity with only 12.5% FDR - this is the optimal threshold. Green shading highlights the recommended q < 0.10 threshold.

---

## Figure 5: Decision Guide

**File**: `fig5_decision_guide.png/pdf`

Visual decision tree for method selection based on analysis goals:

- **Discovery path** (maximize true positives): Leads to ZINB (83% sens, 29% FDR) or Hurdle (83% sens, 25% FDR) at q < 0.05
- **Confirmation path** (minimize false positives): Leads to LinDA at q < 0.10 (39% sens, 12.5% FDR)
- **Unknown distribution path**: Leads to Permutation test (gold standard)

Color coding: Green = discovery methods, Purple = confirmation methods, Blue = sparse data specialists, Gray = non-parametric.

---

## Figure 6: Summary Figure

**File**: `fig6_summary.png/pdf`

Three-panel summary suitable for graphical abstract.

**Panel A (Sensitivity)**: Bar chart comparing sensitivity at 4.0 log2FC. LinDA at q < 0.05 shows 0% (highlighted in red), LinDA at q < 0.10 shows 39%, ZINB and Hurdle at q < 0.05 show 83%.

**Panel B (CLR Attenuation)**: Line plot showing true effect vs observed effect for LinDA. Shaded region shows the 75% attenuation zone. True 4.0 log2FC appears as only 1.0 in CLR space.

**Panel C (Recommendations)**: Text box with key recommendations:
1. Use q < 0.10 for LinDA
2. LinDA needs >8x fold change to detect anything
3. Use ZINB/Hurdle for discovery
4. Use LinDA for confirmation
5. CLR attenuates by ~75%

---

## Technical Notes

- All figures generated at 300 DPI for publication quality
- PDF versions available for vector graphics
- Color scheme:
  - LinDA: #9b59b6 (purple)
  - ZINB: #27ae60 (green)
  - Hurdle: #3498db (blue)
  - NB: #e67e22 (orange)
  - Permutation: #95a5a6 (gray)
- Effect sizes in log2 fold change (1.0 = 2x, 2.0 = 4x, 3.0 = 8x, 4.0 = 16x)
- Generated by `generate_figures.py` using matplotlib

## Key Findings

1. **LinDA requires q < 0.10**: At q < 0.05, LinDA has 0% sensitivity even for 16x fold changes
2. **CLR attenuates by ~75%**: True 4.0 log2FC appears as ~1.0 in CLR-transformed data
3. **ZINB/Hurdle best for discovery**: 83% sensitivity at q < 0.05 with ~25% FDR
4. **LinDA best for confirmation**: 39% sensitivity at q < 0.10 with only 12.5% FDR
5. **Effect size not interpretable for LinDA**: Must multiply by ~4 to approximate true fold change
