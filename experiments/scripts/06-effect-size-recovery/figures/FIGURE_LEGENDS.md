# Figure Legends - Effect Size Recovery Accuracy

## Figure 1: True vs Observed Effect Sizes

**File**: `fig1_true_vs_observed.png/pdf`

Four-panel scatter plot showing true vs observed effect sizes for each method.

**Panels A-D**: Each panel shows one method (LinDA, ZINB, Hurdle, NB) with true effect size on x-axis and observed effect size on y-axis. Each point represents one differential feature. Dashed line shows perfect 1:1 recovery. Solid colored line shows the fitted regression with slope annotation.

**Key observation**: LinDA (Panel A) shows slope ~0.25 (severe attenuation), while ZINB (slope ~0.90), Hurdle (~0.88), and NB (~0.95) closely track the identity line.

---

## Figure 2: Bias Analysis

**File**: `fig2_bias_analysis.png/pdf`

**Panel A (Bias)**: Bar chart showing systematic bias (observed - true) for each method at true effect = 2.0 log2FC. LinDA shows bias of -1.5 (severe underestimation), while ZINB (-0.2), Hurdle (-0.25), and NB (-0.1) show minimal bias.

**Panel B (RMSE)**: Bar chart showing root mean square error for each method. LinDA has the highest RMSE due to systematic attenuation. ZINB and Hurdle have moderate RMSE due to higher variance but less bias.

---

## Figure 3: Method Concordance

**File**: `fig3_method_concordance.png/pdf`

Three-panel scatter plot comparing effect size estimates between method pairs.

**Panel 1 (LinDA vs ZINB)**: Shows poor magnitude concordance but good direction agreement (~85%). LinDA estimates are ~4x smaller than ZINB estimates.

**Panel 2 (LinDA vs Hurdle)**: Similar pattern to Panel 1. Direction agreement >85% but magnitude mismatch.

**Panel 3 (ZINB vs Hurdle)**: Excellent concordance (r > 0.95). Both methods produce comparable effect size estimates.

Each panel shows correlation coefficient (r) and direction agreement percentage.

---

## Figure 4: Attenuation Factors

**File**: `fig4_attenuation_factors.png/pdf`

**Panel A (Effect Size Scaling)**: Line plot showing observed effect vs true effect for each method. LinDA (purple) shows 25% recovery across all effect sizes. ZINB (green), Hurdle (blue), and NB (orange) all track close to the identity line.

**Panel B (True vs LinDA Observed)**: Grouped bar chart directly comparing true effect size (green) with LinDA observed (purple). Annotations show the fold change interpretation. True 4.0 log2FC (16x fold change) appears as only 1.0 log2FC (2x fold change) in LinDA.

---

## Figure 5: Interpretation Guide

**File**: `fig5_interpretation_guide.png/pdf`

Table summarizing how to interpret effect sizes from different methods:

| Method | Observed | True Effect | Interpretation | Use Case |
|--------|----------|-------------|----------------|----------|
| LinDA | 0.5 log2FC | ~2.0 log2FC | 4x fold change (after 4x correction) | Significance testing |
| LinDA | 1.0 log2FC | ~4.0 log2FC | 16x fold change (after 4x correction) | Large effects only |
| ZINB | 2.0 log2FC | ~2.2 log2FC | 4-5x fold change (direct) | Effect size estimation |
| Hurdle | 2.0 log2FC | ~2.3 log2FC | 4-5x fold change (direct) | Sparse data |

Color coding matches method colors used throughout figures.

---

## Figure 6: Summary Figure

**File**: `fig6_summary.png/pdf`

Three-panel summary suitable for graphical abstract.

**Panel A (Effect Size Recovery)**: Bar chart showing percentage of true effect recovered. LinDA: 25%, ZINB: 90%, Hurdle: 88%, NB: 95%. Dashed line indicates perfect (100%) recovery.

**Panel B (Systematic Bias)**: Horizontal bar chart showing bias for each method. LinDA shows large negative bias (-1.5), others show minimal bias.

**Panel C (Recommendations)**: Text box summarizing key findings:
1. LinDA attenuates effect sizes by ~75%
2. ZINB/Hurdle recover ~90% of true effect
3. Cross-method concordance is good for direction
4. Use LinDA for significance testing
5. Use ZINB/Hurdle for effect size estimation

---

## Technical Notes

- All figures generated at 300 DPI for publication quality
- PDF versions available for vector graphics
- Color scheme:
  - LinDA: #9b59b6 (purple)
  - ZINB: #27ae60 (green)
  - Hurdle: #3498db (blue)
  - NB: #e67e22 (orange)
- True effect sizes: 2.0 log2FC (4x fold change) for positive condition
- 18 differential features per synthetic dataset
- Generated by `generate_figures.py` using matplotlib

## Key Findings

1. **CLR attenuates by ~75%**: LinDA recovers only 25% of true effect magnitude
2. **ZINB/Hurdle are accurate**: Both recover ~90% of true effect
3. **Direction agreement is good**: >85% across all method pairs
4. **Magnitude agreement varies**: LinDA vs count-based methods show 4x difference
5. **Effect sizes not comparable across methods**: Cannot directly combine LinDA and ZINB estimates

## Implications for Meta-Analysis

1. **Use consistent methods**: Cannot combine LinDA and ZINB effect sizes directly
2. **Transform if needed**: Multiply LinDA estimates by ~4 to approximate true fold change
3. **Report method used**: Always document which method was used for effect size estimation
4. **Prefer count-based for interpretation**: ZINB/Hurdle effect sizes are directly interpretable
